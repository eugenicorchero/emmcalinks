<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMMCA LINKS | Recursos Musicals Interactius</title>
    
    <!-- Carrega de Tailwind CSS CDN per a estils r√†pids i responsius -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- NOVES Icones: Lucide Icons (M√©s estables en entorns virtuals) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Configuraci√≥ de la font Inter i colors base -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');

        /* NOVA PALETA DE COLORS (Tailwind Custom) */
        :root {
            --color-primary: #3498db; /* Blau Fort */
            --color-secondary: #2980b9; /* Blau Fosc (per hover) */
            --color-dark: #2c3e50; /* Negre/Gris molt fosc */
            --color-light: #ffffff; /* Blanc pur */
            --color-link-bg: #f5f7fa; /* Gris molt clar */
            --color-border: #e4e6eb; /* Gris clar per vores */
            
            --emca-text-color: var(--color-dark);
            --emca-container-bg: var(--color-light);
            --emca-control-icon: #444; /* Gris fosc per a icones de control */
        }

        /* --- Mode Fosc --- */
        .dark-mode {
            --color-primary: #5dade2; 
            --color-secondary: #3498db;
            --color-dark: #f0f0f0; 
            --color-light: #121212; 
            --color-link-bg: #1e1e1e; 
            --color-border: #333;
            
            --emca-text-color: var(--color-dark);
            --emca-container-bg: #121212;
            --emca-control-icon: #f0f0f0; /* Blanc clar per a icones de control */
        }

        /* Estil Global & Tipografia Inter */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--emca-container-bg);
            color: var(--emca-text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        
        /* Ajustos Bulma (Recreats amb Tailwind) */
        .links-container {
            padding: 30px 25px 60px 25px; 
        }

        /* Hero Card Styling - Adaptaci√≥ per a Hero Cards */
        .hero-card {
            border: 1px solid var(--color-border);
            background-color: var(--color-link-bg);
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, background-color 0.3s, border-color 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); 
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .hero-card:hover {
            transform: translateY(-5px); 
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); 
            background-color: var(--color-secondary);
            border-color: var(--color-secondary);
            color: var(--color-light) !important; 
        }
        
        .hero-card:hover h2, 
        .hero-card:hover .icon-symbol {
            color: var(--color-light) !important;
        }

        .hero-card h2 {
            color: var(--color-primary);
            transition: color 0.3s;
        }

        .hero-card:hover p {
            color: #f0f0f0; /* Gris clar en hover */
        }

        .icon-symbol {
            font-size: 2.5rem;
            line-height: 1;
            /* Estil per a les icones d'emoji/lucide en Hero */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-symbol svg {
            width: 2.5rem;
            height: 2.5rem;
        }

        /* Estil per als botons est√†ndard (fora del Hero) */
        .link-button {
            background-color: var(--color-link-bg);
            color: var(--emca-text-color) !important;
            border: none;
            font-weight: 600;
            margin-bottom: 0.75rem; 
            transition: all 0.2s ease-in-out, background-color 0.3s;
            text-align: left;
            padding: 1rem 1.4rem; 
            height: auto;
            white-space: normal;
            display: flex;
            align-items: center;
            border-radius: 0.625rem; /* 10px */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); 
        }
        
        .link-button:hover, .link-button:focus {
            background-color: var(--color-primary);
            color: var(--color-light) !important;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1); 
            transform: translateY(-2px);
        }

        .link-button .icon {
            margin-right: 1.2rem;
            font-size: 1.3rem;
            color: var(--color-primary);
            transition: color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Ajustar SVG de Lucide dins de .icon */
        .link-button .icon svg {
             width: 1.3rem;
             height: 1.3rem;
        }

        .link-button:hover .icon, .link-button:focus .icon {
            color: var(--color-light);
        }

        /* Controls de Cap√ßalera (Fixed) - Z-INDEX 900 */
        .header-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 900; /* REFOR√áAT */
        }

        .header-controls button {
            margin-left: 0.5rem;
            color: var(--emca-control-icon);
            background-color: rgba(255, 255, 255, 0.95); /* Menys transparent */
            backdrop-filter: blur(8px); /* Blur m√©s fort */
            border: 1px solid var(--color-border);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Ombra m√©s visible */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .dark-mode .header-controls button {
            background-color: rgba(0, 0, 0, 0.7); /* Fons fosc amb transpar√®ncia */
            border: 1px solid #333;
            box-shadow: 0 4px 8px rgba(255, 255, 255, 0.05);
        }
        .header-controls button:hover {
            color: var(--color-primary);
            transform: scale(1.05);
        }
        /* Ajust per a icones Lucide dins dels botons de control */
        .header-controls button svg {
            width: 1rem;
            height: 1rem;
            stroke-width: 2.5; /* M√©s gruixut per visibilitat */
        }


        /* Estil Pestanyes (Tabs - Recreant Bulma amb Tailwind) */
        .tabs-container ul {
            display: flex;
            justify-content: center;
            border-bottom: 2px solid var(--color-border);
            margin-bottom: 1.5rem;
        }

        .tabs-container li {
            padding: 0 1rem;
            margin-bottom: -2px; /* Superposici√≥ sobre la l√≠nia */
            cursor: pointer;
        }

        .tabs-container li a {
            display: flex;
            align-items: center;
            padding: 0.75rem 0;
            color: var(--emca-text-color);
            transition: color 0.3s;
        }

        .tabs-container li.is-active a {
            border-bottom: 2px solid var(--color-primary);
            color: var(--color-primary) !important;
            font-weight: 600;
        }
        
        /* Utilitats i Materials App Links Styling */
        .app-links a {
            color: var(--emca-text-color);
            opacity: 0.8;
            transition: opacity 0.2s;
        }
        .link-button:hover .app-links .icon {
             color: var(--color-light); 
        }
        
        /* Collapsible Styling */
        .collapsible-header {
            cursor: pointer;
            padding: 12px 0; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            color: var(--color-dark); 
            transition: color 0.3s;
            border-bottom: 1px solid var(--color-border);
        }
        .dark-mode .collapsible-header {
            color: var(--color-dark); 
        }
        .collapsible-header:hover {
            color: var(--color-primary);
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding-top: 15px; 
            padding-bottom: 10px; 
        }
        .collapsible-content.is-expanded {
            max-height: 3000px; 
            transition: max-height 0.5s ease-in;
        }
        .collapsible-header .icon svg { /* Lucide icones a collapsible */
            transition: transform 0.3s;
        }
        .collapsible-header.is-expanded .icon svg {
            transform: rotate(180deg);
        }

        /* --- Modal Styling --- */
        .search-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .search-modal-content {
            background-color: var(--emca-container-bg);
            border-radius: 12px;
            padding: 2rem;
            max-width: 90%;
            width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        .link-item-title {
            color: var(--color-primary); 
            font-weight: 700;
            font-size: 1.35rem !important; 
            padding-bottom: 5px;
            margin-bottom: 1.5rem !important;
            border-bottom: 1px solid var(--color-border);
        }
        
        /* Compact View Styling (Recreat) */
        .compact-view-active .hero-card h2 { margin-bottom: 0 !important; }
        .compact-view-active .hero-card p { display: none !important; }
        
        .link-button.is-download {
            background-color: var(--color-primary);
            color: var(--color-light) !important;
        }
        .link-button.is-download .icon {
            color: var(--color-light) !important;
        }
        .link-button.is-download:hover {
            background-color: var(--color-secondary);
            transform: scale(1.02);
        }
        
        /* Utilitats App Links: Ocultar subt√≠tols en vista compacta */
        .compact-view-active .link-button .is-size-7 {
            display: none !important;
        }
        .compact-view-active .link-button .app-links {
            margin-top: 0 !important;
        }
        
        /* M√≤bil */
        @media (max-width: 768px) {
             .links-container { 
                padding: 15px 15px 60px 15px; 
            }
            .header-controls {
                top: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body class="min-h-screen antialiased">

    <!-- Controls Interactius de la Cap√ßalera (Fixed) - Z-INDEX 900 -->
    <div class="header-controls flex items-center">
        <!-- Cerca -->
        <button class="w-9 h-9 rounded-full flex items-center justify-center shadow-lg transition duration-200" id="openSearchModal" title="Obrir Cerca i Filtres">
            <i data-lucide="search"></i> <!-- Icona Lucide -->
        </button>
        <!-- Mode Fosc -->
        <button class="w-9 h-9 rounded-full flex items-center justify-center shadow-lg transition duration-200" id="darkModeToggle" title="Activar/Desactivar Mode Fosc">
            <i data-lucide="moon"></i> <!-- Icona Lucide -->
        </button>
        <!-- Vista Compacta -->
        <button class="w-9 h-9 rounded-full flex items-center justify-center shadow-lg transition duration-200" id="compactViewToggle" title="Canviar a Vista Compacta">
            <i data-lucide="list"></i> <!-- Icona Lucide -->
        </button>
    </div>

    <div class="links-container w-full max-w-7xl mx-auto">

        <!-- Cap√ßalera Principal -->
        <header class="text-center pt-10 pb-5">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 mb-2" style="color: var(--color-dark);">EMMCA LINKS</h1>
            <p class="text-xl text-gray-500" style="color: var(--emca-text-color); opacity: 0.8;">Recursos Musicals Essencials per a l'Estudiant</p>
        </header>

        <!-- Secci√≥ 1: ENLLA√áOS DESTACATS (HERO) -->
        <h3 class="text-2xl font-bold text-center mt-12 mb-8" style="color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 8px;">Eines d'Entrenament Essencials üí°</h3>
        
        <!-- Contenidor de les Targetes (Responsive Grid - 1/2/3/6 Columnes) -->
        <div class="grid grid-cols-1 gap-6 
                    sm:grid-cols-2 
                    lg:grid-cols-3
                    xl:grid-cols-6 link-list highlighted-links" data-category="eines teoria lectura auditiva intervals acords" style="margin-bottom: 3rem;">
            
            <!-- 1. Lectura Clau de Sol -->
            <div class="link-item" data-category="eines lectura">
                <a href="https://emmcaro.github.io/lecturabasic1/" target="_blank" rel="noopener noreferrer" class="hero-card block p-6 rounded-xl">
                    <div class="flex flex-col items-start space-y-3">
                        <span class="icon-symbol text-blue-600" aria-hidden="true">ùÑû</span>
                        <h2 class="text-xl font-bold">Lectura Clau de Sol</h2>
                        <p class="text-gray-500 text-sm">Practica la identificaci√≥ r√†pida de notes al pentagrama en clau de sol.</p>
                    </div>
                </a>
            </div>

            <!-- 2. Lectura Clau de Fa -->
            <div class="link-item" data-category="eines lectura">
                <a href="https://emmcaro.github.io/Lectura-clau-de-fa/" target="_blank" rel="noopener noreferrer" class="hero-card block p-6 rounded-xl">
                    <div class="flex flex-col items-start space-y-3">
                        <span class="icon-symbol text-purple-600" aria-hidden="true">ùÑ¢</span>
                        <h2 class="text-xl font-bold">Lectura Clau de Fa</h2>
                        <p class="text-gray-500 text-sm">Domina la lectura de les notes greus utilitzant la clau de fa.</p>
                    </div>
                </a>
            </div>

            <!-- 3. Lectura d'Intervals (Visuals) -->
            <div class="link-item" data-category="eines teoria intervals lectura">
                <a href="https://eugenicorchero.github.io/intervally/" target="_blank" rel="noopener noreferrer" class="hero-card block p-6 rounded-xl">
                    <div class="flex flex-col items-start space-y-3">
                        <span class="icon-symbol text-green-600" aria-hidden="true">üéº</span>
                        <h2 class="text-xl font-bold">Lectura d'Intervals</h2>
                        <p class="text-gray-500 text-sm">Exercicis visuals per recon√®ixer els diferents intervals mel√≤dics i harm√≤nics.</p>
                    </div>
                </a>
            </div>

            <!-- 4. Dictats Auditius d'Intervals -->
            <div class="link-item" data-category="eines teoria intervals auditiva">
                <a href="https://eugenicorchero.github.io/auditorium/" target="_blank" rel="noopener noreferrer" class="hero-card block p-6 rounded-xl">
                    <div class="flex flex-col items-start space-y-3">
                        <span class="icon-symbol text-red-600" aria-hidden="true">üëÇ</span>
                        <h2 class="text-xl font-bold">Dictats Auditius d'Intervals</h2>
                        <p class="text-gray-500 text-sm">Entrena l'o√Øda per identificar intervals a partir de la seva sonoritat (sense suport visual).</p>
                    </div>
                </a>
            </div>

            <!-- 5. Dictats Auditius d'Acords -->
            <div class="link-item" data-category="eines teoria acords auditiva nou">
                <a href="https://eugenicorchero.github.io/chordiceps/" target="_blank" rel="noopener noreferrer" class="hero-card block p-6 rounded-xl">
                    <div class="flex flex-col items-start space-y-3">
                        <span class="icon-symbol text-yellow-600" aria-hidden="true">üé∏</span>
                        <h2 class="text-xl font-bold">Dictats Auditius d'Acords</h2>
                        <p class="text-gray-500 text-sm">Reconeix i anomena la qualitat dels acords (majors, menors, setena, etc.) a l'o√Øda.</p>
                    </div>
                </a>
            </div>
            
            <!-- 6. NOU: Temporitzador d'Estudi Diari -->
            <div class="link-item" data-category="eines utilitats timer estudi organitzacio nou">
                <a href="https://eugenicorchero.github.io/musicstudy/" target="_blank" rel="noopener noreferrer" class="hero-card block p-6 rounded-xl">
                    <div class="flex flex-col items-start space-y-3">
                        <span class="icon-symbol text-orange-600" aria-hidden="true"><i data-lucide="timer"></i></span> <!-- Icona Lucide -->
                        <h2 class="text-xl font-bold">Temporitzador d'Estudi Diari</h2>
                        <p class="text-gray-500 text-sm">Eina Pomodoro personalitzada per estructurar i cronometrar les sessions de pr√†ctica.</p>
                    </div>
                </a>
            </div>
            
        </div>
        <!-- Fi Contenidor Targetes -->
        
        <!-- Secci√≥ 2: NAVEGACI√ì PER PESTANYES (TABS) -->
        <h3 class="text-2xl font-bold text-center mt-12 mb-8" style="color: var(--color-primary); border-bottom: 2px solid var(--color-primary); padding-bottom: 8px;">Directori Tem√†tic üìö</h3>

        <!-- Tabs Container (Recreat amb Tailwind) -->
        <div class="tabs-container">
            <ul id="tabs-header">
                <li data-target="tab-teoria" class="is-active">
                    <a class="flex items-center space-x-2">
                        <span class="icon is-small"><i data-lucide="graduation-cap"></i></span> <!-- Icona Lucide -->
                        <span>Teoria i Refer√®ncia</span>
                    </a>
                </li>
                <li data-target="tab-produccio">
                    <a class="flex items-center space-x-2">
                        <span class="icon is-small"><i data-lucide="sliders-horizontal"></i></span> <!-- Icona Lucide -->
                        <span>Producci√≥ i Creativitat</span>
                    </a>
                </li>
                <li data-target="tab-utilitats">
                    <a class="flex items-center space-x-2">
                        <span class="icon is-small"><i data-lucide="smartphone"></i></span> <!-- Icona Lucide -->
                        <span>Utilitats i Materials</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- CONTINGUT DE LES PESTANYES -->
        <div id="tabs-content">

            <!-- PESTANYA 1: TEORIA I REFER√àNCIA -->
            <div id="tab-teoria" class="tab-pane">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 standard-links" data-category="teoria youtube">
                    
                    <!-- Columna 1.1: Webs de Refer√®ncia -->
                    <div class="link-col" data-category="teoria eines">
                        <p class="link-item-title">Eines Web de Teoria i Dictats</p>
                        
                        <div class="link-group">
                            <a class="w-full link-button link-item" href="https://teoria.com/index.php" target="_blank" rel="noopener noreferrer" data-category="teoria eines dictats">
                                <span class="icon"><i data-lucide="book-open"></i></span> <!-- Icona Lucide -->
                                <span>Teoria.com (Teoria i dictats)</span>
                            </a>
                            <a class="w-full link-button link-item" href="https://www.musictheory.net" target="_blank" rel="noopener noreferrer" data-category="teoria eines didactica">
                                <span class="icon"><i data-lucide="book"></i></span> <!-- Icona Lucide -->
                                <span>Music Theory (Recursos did√†ctics)</span>
                            </a>
                        </div>
                    </div>

                    <!-- Columna 1.2: Canals de YouTube - Teoria i An√†lisi -->
                    <div class="link-col" data-category="youtube teoria">
                        <!-- Grup Plegable: YouTube Teoria -->
                        <div class="mt-0">
                            <div class="collapsible-header" data-target="youtube-teoria-links" style="margin-top: 0;">
                                <p class="link-item-title" style="border-bottom: none; margin-bottom: 0;">Canals de YouTube - Teoria i An√†lisi üì∫</p>
                                <span class="icon"><i data-lucide="chevron-down"></i></span> <!-- Icona Lucide -->
                            </div>
                            <div id="youtube-teoria-links" class="collapsible-content link-group" data-category="youtube teoria">
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/AdamNeely" target="_blank" rel="noopener noreferrer" data-category="youtube teoria jazz">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Adam Neely</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/RickBeato" target="_blank" rel="noopener noreferrer" data-category="youtube teoria rock">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Rick Beato</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/JaimeAltozano" target="_blank" rel="noopener noreferrer" data-category="youtube analisis pop">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Jaime Altozano</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/AimeeNolte" target="_blank" rel="noopener noreferrer" data-category="youtube teoria jazz piano">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Aimee Nolte</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/NahreSol" target="_blank" rel="noopener noreferrer" data-category="youtube teoria piano clasica">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Nahre Sol</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/channel/UCTUtqcDkzw7bisadh6AOx5w" target="_blank" rel="noopener noreferrer" data-category="youtube teoria analisi">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>12Tone</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/8bitMusicTheory" target="_blank" rel="noopener noreferrer" data-category="youtube teoria games">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>8bit Music Theory</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/CharlesCornellStudios" target="_blank" rel="noopener noreferrer" data-category="youtube teoria jazz">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Charles Cornell</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/DeadWaxShow" target="_blank" rel="noopener noreferrer" data-category="youtube teoria produccio">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Dead Wax</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/bobreynolds" target="_blank" rel="noopener noreferrer" data-category="youtube teoria jazz saxo">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Bob Reynolds</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/channel/UCUGf7OXXPWxai-FeLi7N-WA" target="_blank" rel="noopener noreferrer" data-category="youtube teoria produccio">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Music Radar Clan</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PESTANYA 2: PRODUCCI√ì I CREATIVITAT -->
            <div id="tab-produccio" class="tab-pane" style="display: none;">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 standard-links" data-category="eines produccio youtube podcast">
                    
                    <!-- Columna 2.1: Eines de Creativitat -->
                    <div class="link-col" data-category="eines creativitat produccio">
                        <p class="link-item-title">Eines Web de Creativitat i Producci√≥</p>
                        
                        <div class="link-group">
                            <a class="w-full link-button link-item" href="https://musiclab.chromeexperiments.com/" target="_blank" rel="noopener noreferrer" data-category="eines creativitat experimentacio">
                                <span class="icon"><i data-lucide="palette"></i></span> <!-- Icona Lucide -->
                                <span>Chrome Music Lab (Experimentaci√≥)</span>
                            </a>
                            <a class="w-full link-button link-item" href="https://muted.io" target="_blank" rel="noopener noreferrer" data-category="eines produccio utilitats">
                                <span class="icon"><i data-lucide="tool"></i></span> <!-- Icona Lucide -->
                                <span>Muted io (Eines v√†ries de producci√≥)</span>
                            </a>
                        </div>
                    </div>

                    <!-- Columna 2.2: Canals de YouTube i Podcasts -->
                    <div class="link-col" data-category="youtube produccio podcast">
                         
                         <!-- Grup Plegable: Podcasts -->
                        <div class="mt-0">
                            <div class="collapsible-header" data-target="podcast-links" style="margin-top: 0;">
                                <p class="link-item-title" style="border-bottom: none; margin-bottom: 0;">Podcasts d'Inter√®s üéß</p>
                                <span class="icon"><i data-lucide="chevron-down"></i></span> <!-- Icona Lucide -->
                            </div>
                            <div id="podcast-links" class="collapsible-content link-group" data-category="podcast entrevista analisi">
                                <a class="w-full link-button link-item" href="https://open.spotify.com/show/5Br33snnJU90k2NcYskuM9?si=9a82970a42c34733" target="_blank" rel="noopener noreferrer" data-category="podcast entrevista produccio">
                                    <span class="icon"><i data-lucide="podcast"></i></span> <!-- Icona Lucide -->
                                    <span>Tape Notes</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://open.spotify.com/show/1sgWaKtQxwfjUpZnnK8r7J?si=d7dede0f96eb41ec" target="_blank" rel="noopener noreferrer" data-category="podcast analisis pop">
                                    <span class="icon"><i data-lucide="podcast"></i></span> <!-- Icona Lucide -->
                                    <span>Switched On Pop</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://open.spotify.com/show/10lMwCjvzLCLwth2AW6cLG?si=039962dd03494b8f" target="_blank" rel="noopener noreferrer" data-category="podcast analisis produccio">
                                    <span class="icon"><i data-lucide="podcast"></i></span> <!-- Icona Lucide -->
                                    <span>Song Explorer</span>
                                </a>
                            </div>
                        </div>
                         
                        <!-- Grup Plegable: YouTube Producci√≥ -->
                        <div class="mt-5">
                            <div class="collapsible-header" data-target="youtube-produccio-links">
                                <p class="link-item-title" style="border-bottom: none; margin-bottom: 0;">Canals de YouTube - Producci√≥ Musical üéõÔ∏è</p>
                                <span class="icon"><i data-lucide="chevron-down"></i></span> <!-- Icona Lucide -->
                            </div>
                            <div id="youtube-produccio-links" class="collapsible-content link-group" data-category="youtube produccio">
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/andrewhuang" target="_blank" rel="noopener noreferrer" data-category="youtube produccio creativitat">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Andrew Huang</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/c/Producelikeapro" target="_blank" rel="noopener noreferrer" data-category="youtube produccio mixing">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Produce Like A Pro</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/Z3NWorld" target="_blank" rel="noopener noreferrer" data-category="youtube produccio ableton">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Zen World</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/@HelpMeDevvon" target="_blank" rel="noopener noreferrer" data-category="youtube produccio r&b">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Help Me Devvon</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/@VenusTheory" target="_blank" rel="noopener noreferrer" data-category="youtube produccio sound design">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Venus Theory</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/@ReidStefanMusic" target="_blank" rel="noopener noreferrer" data-category="youtube produccio pop">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Reid Stefan</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/WVmusicOrg" target="_blank" rel="noopener noreferrer" data-category="youtube produccio entrevista">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Weathervane Music</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/imamusicmogul" target="_blank" rel="noopener noreferrer" data-category="youtube produccio marketing">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Music Mogul</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/channel/UCUGf7OXXPWxai-FeLi7N-WA" target="_blank" rel="noopener noreferrer" data-category="youtube produccio pop">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Make Pop Music</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/theproaudiofiles" target="_blank" rel="noopener noreferrer" data-category="youtube produccio mixing">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Pro Audio Files</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/rachelkcollieroff" target="_blank" rel="noopener noreferrer" data-category="youtube produccio live loop">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Rachel K Collier</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/SeanDivine" target="_blank" rel="noopener noreferrer" data-category="youtube produccio mixing">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Sean Divine</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/channel/UCJpVRw_1bcGrQvUxeXz8Uhw" target="_blank" rel="noopener noreferrer" data-category="youtube produccio sound design">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Mars Citizen</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/user/cosmcosm" target="_blank" rel="noopener noreferrer" data-category="youtube produccio ableton">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Tom Cosm</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/channel/UCUGf7OXXPWxai-FeLi7N-WA" target="_blank" rel="noopener noreferrer" data-category="youtube produccio mastering">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Weiss Advice</span>
                                </a>
                                <a class="w-full link-button link-item" href="https://www.youtube.com/@TheVelvetYear" target="_blank" rel="noopener noreferrer" data-category="youtube produccio synth">
                                    <span class="icon"><i data-lucide="youtube"></i></span> <!-- Icona Lucide -->
                                    <span>Velvet Year</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PESTANYA 3: UTILITATS I MATERIALS -->
            <div id="tab-utilitats" class="tab-pane" style="display: none;">
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8 standard-links" data-category="app pdf">

                    <!-- Columna 3.1: Aplicacions -->
                    <div class="link-col" data-category="app metronom stemps entrenament">
                        
                        <!-- Grup Plegable: Apps Recomanades -->
                        <div>
                            <div class="collapsible-header is-expanded" data-target="recommended-apps-links" style="margin-top: 0;">
                                <p class="link-item-title" style="border-bottom: none; margin-bottom: 0;">Utilitats Essencials per a la Pr√†ctica üì±</p>
                                <span class="icon"><i data-lucide="chevron-down"></i></span> <!-- Icona Lucide -->
                            </div>
                            <div id="recommended-apps-links" class="collapsible-content is-expanded link-group" data-category="app metronom stemps">
                                
                                <!-- App 1: SBL Groove Trainer (Metr√≤nom avan√ßat) -->
                                <div class="w-full link-button link-item" data-category="app metronom groove bateria" style="margin-bottom: 1.2rem;">
                                    <span class="icon"><i data-lucide="drum"></i></span> <!-- Icona Lucide -->
                                    <div class="flex-grow">
                                        <p class="text-base font-bold">SBL Groove Trainer (Metr√≤nom)</p>
                                        <p class="is-size-7 text-gray-500">El metr√≤nom avan√ßat per a l'entrenament r√≠tmic.</p>
                                        <div class="app-links flex space-x-4 mt-4">
                                            <!-- ENLLA√á iOS/Mac -->
                                            <a href="https://apps.apple.com/us/app/sbl-groove-trainer/id1571452765" target="_blank" rel="noopener noreferrer" title="SBL Groove Trainer a App Store (iOS/Mac)">
                                                <span class="icon text-2xl" style="margin-right: 0;"><i data-lucide="apple"></i></span> <!-- Icona Lucide -->
                                            </a>
                                             <!-- ENLLA√á Android - SVG ROBOT D'ANDROID -->
                                            <a href="https://play.google.com/store/apps/details?id=com.scottsbasslessons.groovetrainer&hl=es_419&pli=1" target="_blank" rel="noopener noreferrer" title="SBL Groove Trainer a Google Play (Android)">
                                            <span class="icon text-2xl" style="margin-right: 0;"><i data-lucide="android"></i></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- App 2: Moises (Separaci√≥ de stemps) -->
                                <div class="w-full link-button link-item" data-category="app stemps produccio karaoke">
                                    <span class="icon"><i data-lucide="music-4"></i></span> <!-- Icona Lucide -->
                                    <div class="flex-grow">
                                        <p class="text-base font-bold">Moises (Separador de Stems)</p>
                                        <p class="is-size-7 text-gray-500">Separa veus, bateria i altres instruments d'una can√ß√≥ qualsevol.</p>
                                        <div class="app-links flex space-x-4 mt-4">
                                            <!-- ENLLA√á iOS/Mac -->
                                            <a href="https://apps.apple.com/es/app/moises-la-app-para-m%C3%BAsics/id1515796612" target="_blank" rel="noopener noreferrer" title="Moises a App Store (iOS/Mac)">
                                                <span class="icon text-2xl" style="margin-right: 0;"><i data-lucide="apple"></i></span> <!-- Icona Lucide -->
                                            </a>
                                            <!-- ENLLA√á Android - SVG ROBOT D'ANDROID -->
                                            <a href="https://play.google.com/store/apps/details?id=ai.moises&hl=es_419" target="_blank" rel="noopener noreferrer" title="Moises a Google Play (Android)">
                                            <span class="icon text-2xl" style="margin-right: 0;"><i data-lucide="android"></i></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    
                    <!-- Columna 3.2: Documents PDF -->
                    <div class="link-col" data-category="document pdf curs material">
                        <p class="link-item-title">Materials de Curs (PDFs)</p>

                        <div class="link-group" data-category="pdf material harmonia teoria">
                            <!-- PDF 1: LLIBRE D'HARMONIA B√ÄSICA -->
                            <a class="w-full link-button link-item is-download" 
                               href="https://drive.google.com/file/d/1uXKDGcUFRG-pb14TFmutK7jpjbHzEMgd/view?usp=sharing" 
                               target="_blank" 
                               rel="noopener noreferrer" 
                               data-category="pdf teoria harmonia llibre">
                                <span class="icon"><i data-lucide="file-text"></i></span> <!-- Icona Lucide -->
                                <div style="text-align: left;">
                                    <p class="text-base font-bold">Veure i Descarregar: Llibre d'Harmonia B√†sica</p>
                                    <p class="text-sm" style="color: var(--color-link-bg); opacity: 0.8;">Obre la visualitzaci√≥ de Drive per descarregar l'√∫ltima versi√≥.</p>
                                </div>
                            </a>
                            
                            <a class="w-full link-button link-item" 
                               href="https://drive.google.com/uc?export=download&id=EXAMPLE_FILE_ID_2" 
                               target="_blank" 
                               rel="noopener noreferrer" 
                               data-category="pdf exercicis">
                                <span class="icon"><i data-lucide="clipboard-list"></i></span> <!-- Icona Lucide -->
                                <span>Llista d'Exercicis Setmanals (PLANTILLA)</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

        </div> <!-- Fi del Contenidor de Pestanyes -->
        
    </div> <!-- Fi del links-container -->

    <!-- Peu de P√†gina (Footer) -->
    <footer class="text-center py-6 text-gray-500 text-sm">
        <p>
            <i data-lucide="copyright"></i> Copyright **Eugeni Corchero** 2025 | Creat per a l'EMMCA
        </p>
    </footer>

    <!-- Modal de Cerca i Filtres (Ocult per defecte) -->
    <div id="searchModal" class="search-modal" style="display: none;">
        <div class="search-modal-content">
            <h3 class="text-2xl font-bold text-center mb-5" style="color: var(--color-primary);">Cerca i Filtres</h3>
            
            <!-- Funci√≥ 1: Cerca Interactiva (Amb bot√≥ de neteja) -->
            <div class="mb-4">
                <div class="relative">
                    <input class="w-full p-4 text-lg border border-gray-300 rounded-lg pl-10" type="text" id="searchInputModal" placeholder="üîç Cerca per t√≠tol, descripci√≥ o categoria...">
                    <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                        <i data-lucide="search"></i> <!-- Icona Lucide -->
                    </span>
                    <!-- Bot√≥ per Netejar Cerca -->
                    <span class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 cursor-pointer" id="clearSearchInput" style="display: none;">
                        <i data-lucide="x"></i> <!-- Icona Lucide -->
                    </span>
                </div>
            </div>

            <!-- Funci√≥ 2: Filtres Din√†mics (Botons) -->
            <div class="flex flex-wrap justify-center gap-2 mt-4">
                <button class="px-4 py-2 text-sm font-semibold rounded-full filter-btn bg-blue-500 text-white" data-filter="all">Tots</button>
                <button class="px-4 py-2 text-sm font-semibold rounded-full filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300" data-filter="teoria">Teoria</button>
                <button class="px-4 py-2 text-sm font-semibold rounded-full filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300" data-filter="produccio">Producci√≥</button>
                <button class="px-4 py-2 text-sm font-semibold rounded-full filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300" data-filter="app">Apps</button>
                <button class="px-4 py-2 text-sm font-semibold rounded-full filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300" data-filter="pdf">PDF</button>
                <button class="px-4 py-2 text-sm font-semibold rounded-full filter-btn bg-gray-200 text-gray-700 hover:bg-gray-300" data-filter="eines">Eines</button>
            </div>
            
            <!-- CONTENIDOR DE RESULTATS DINS DEL POPUP -->
            <div id="searchResultsList" class="mt-8 border-t border-gray-300 pt-5" style="max-height: 55vh; overflow-y: auto;">
                <p class="text-gray-400 text-center" id="searchPlaceholder">Comen√ßa a escriure o selecciona un filtre...</p>
            </div>

            <div class="flex justify-end mt-6">
                <button class="px-4 py-2 text-sm font-semibold rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 transition duration-200" id="closeSearchModal">Tanca</button>
            </div>
        </div>
    </div>

    <script>
        // --- Refer√®ncies als elements del DOM ---
        const body = document.body;
        const searchModal = document.getElementById('searchModal');
        const searchInputModal = document.getElementById('searchInputModal');
        const openSearchModalBtn = document.getElementById('openSearchModal');
        const closeSearchModalBtn = document.getElementById('closeSearchModal');
        const clearSearchInputBtn = document.getElementById('clearSearchInput');
        const resultsList = document.getElementById('searchResultsList');
        const searchPlaceholder = document.getElementById('searchPlaceholder');
        const filterButtons = document.querySelectorAll('#searchModal .filter-btn');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const compactViewToggle = document.getElementById('compactViewToggle');
        
        // Recuperar tots els elements de link de la p√†gina (Hero i Standard)
        const linkItems = document.querySelectorAll('.link-item'); 
        
        // Refer√®ncies per a les pestanyes
        const tabHeaders = document.querySelectorAll('.tabs-container li');
        const tabPanes = document.querySelectorAll('.tab-pane');

        // --- Funci√≥ per gestionar el canvi de pestanyes ---
        function switchTab(targetId) {
            tabHeaders.forEach(header => header.classList.remove('is-active'));
            tabPanes.forEach(pane => pane.style.display = 'none');

            const activeHeader = document.querySelector(`.tabs-container li[data-target="${targetId}"]`);
            if (activeHeader) {
                activeHeader.classList.add('is-active');
            }

            const activePane = document.getElementById(targetId);
            if (activePane) {
                activePane.style.display = 'block';
            }
            
            // Reinicialitzar l'estat dels Collapsibles de la nova pestanya
            setupCollapsibles(); 
        }
        
        // --- Funci√≥ de Collapsible/Accordion Header ---
        function setupCollapsibles() {
            document.querySelectorAll('.collapsible-header').forEach(header => {
                const targetId = header.dataset.target;
                const content = document.getElementById(targetId);

                if (content) {
                    const isAppsCollapsible = targetId === 'recommended-apps-links';
                    const parentPane = header.closest('.tab-pane');

                    // Reinicialitzar estat: nom√©s les Apps de la pestanya Utilitats obertes per defecte
                    if (isAppsCollapsible && parentPane && parentPane.id === 'tab-utilitats') {
                        content.classList.add('is-expanded');
                        header.classList.add('is-expanded');
                    } else {
                        content.classList.remove('is-expanded');
                        header.classList.remove('is-expanded');
                    }
                }

                // Evitar m√∫ltiples listeners
                header.removeEventListener('click', handleCollapsibleClick);
                header.addEventListener('click', handleCollapsibleClick);
            });
        }

        function handleCollapsibleClick(event) {
            const header = event.currentTarget;
            const targetId = header.dataset.target;
            const content = document.getElementById(targetId);
            const activePane = header.closest('.tab-pane');
            
            // Tancar altres collapsibles de la mateixa pestanya
            if (activePane) {
                activePane.querySelectorAll('.collapsible-content.is-expanded').forEach(expandedContent => {
                    if (expandedContent.id !== targetId) {
                        expandedContent.classList.remove('is-expanded');
                        if (expandedContent.previousElementSibling) {
                            expandedContent.previousElementSibling.classList.remove('is-expanded');
                        }
                    }
                });
            }

            if (content) {
                content.classList.toggle('is-expanded');
            }
            header.classList.toggle('is-expanded');
        }

        // --- Funci√≥ per gestionar la Cerca i Filtre al Modal ---
        function filterLinks(filterCategory = null) {
            const searchValue = searchInputModal.value.toLowerCase().trim();
            resultsList.innerHTML = '';
            let foundCount = 0;
            
            // Determinar filtre actiu
            let currentFilter = filterCategory || document.querySelector('#searchModal .filter-btn.bg-blue-500')?.dataset.filter || 'all';

            if (filterCategory) {
                filterButtons.forEach(btn => {
                    btn.classList.remove('bg-blue-500', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                    if (btn.dataset.filter === currentFilter) {
                        btn.classList.add('bg-blue-500', 'text-white');
                        btn.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                    }
                });
            }

            linkItems.forEach(item => {
                const titleElement = item.querySelector('h2') || item.querySelector('span:not(.icon)') || item.querySelector('.text-base.font-bold');
                const descriptionElement = item.querySelector('p:not(.text-gray-400)') || item.querySelector('.is-size-7');

                const title = titleElement ? titleElement.textContent.toLowerCase() : '';
                const description = descriptionElement ? descriptionElement.textContent.toLowerCase() : '';
                const categories = item.dataset.category || '';
                
                let isVisibleBySearch = true;
                if (searchValue.length > 0) {
                    isVisibleBySearch = title.includes(searchValue) || description.includes(searchValue) || categories.includes(searchValue);
                }

                let isVisibleByFilter = true;
                if (currentFilter !== 'all') {
                    isVisibleByFilter = categories.includes(currentFilter);
                }

                if (isVisibleBySearch && isVisibleByFilter) {
                    let itemToClone;
                    
                    if (item.closest('.highlighted-links')) {
                        // Clonar la targeta sencera del Hero
                        itemToClone = item.cloneNode(true);
                        itemToClone.classList.add('mb-4');
                        itemToClone.classList.remove('link-item');
                        
                        const aTag = itemToClone.querySelector('a');
                        if(aTag) {
                            aTag.classList.remove('hero-card');
                            aTag.classList.add('link-button', 'w-full', 'p-4', 'flex', 'items-center');
                            
                            // Adaptar icona i text
                            const iconSymbol = aTag.querySelector('.icon-symbol');
                            if (iconSymbol) {
                                iconSymbol.classList.remove('icon-symbol');
                                iconSymbol.classList.add('icon', 'text-2xl');
                                iconSymbol.style.marginRight = '1.2rem';
                                iconSymbol.style.color = 'var(--color-primary)'; 
                                
                                // Assegurar que les icones Lucide del Hero es renderitzen
                                const lucideIcon = iconSymbol.querySelector('[data-lucide]');
                                if(lucideIcon) {
                                     lucideIcon.setAttribute('data-lucide', lucideIcon.getAttribute('data-lucide')); // For√ßar re-renderitzat
                                }
                            }

                            const h2 = aTag.querySelector('h2');
                            if (h2) { h2.classList.replace('text-xl', 'text-base'); h2.classList.add('font-semibold'); }
                            const p = aTag.querySelector('p');
                            if (p) { p.classList.replace('text-sm', 'text-xs'); }
                            
                            // Eliminar hover del modal
                            aTag.classList.remove('hover:shadow-xl', 'hover:scale-[1.02]');
                        }
                        
                        // Embolcallar amb un div per replicar la llista de botons
                        const tempWrapper = document.createElement('div');
                        tempWrapper.appendChild(itemToClone);
                        itemToClone = tempWrapper;
                        
                    } else {
                        // Si √©s un enlla√ß est√†ndard (bot√≥ o div d'app)
                        itemToClone = item.cloneNode(true);
                        itemToClone.classList.add('mb-4'); 
                        
                        // Netejar classes d'espaiat de l'element original
                        itemToClone.classList.remove('link-item'); 
                    }
                    
                    // Aplicar configuraci√≥ de vista compacta si est√† activa
                    const actualItem = itemToClone.querySelector('a') || itemToClone;
                    
                    if (body.classList.contains('compact-view-active')) {
                        const subtitle = actualItem.querySelector('.text-sm') || actualItem.querySelector('.is-size-7');
                        if (subtitle) subtitle.style.display = 'none';
                        
                        const appLinks = actualItem.querySelector('.app-links');
                        if (appLinks) {
                            const desc = actualItem.querySelector('.is-size-7');
                            if (desc) desc.style.display = 'none';
                            appLinks.style.marginTop = '0';
                        }
                    } 

                    resultsList.appendChild(itemToClone);
                    foundCount++;
                }
            });

            if (foundCount === 0) {
                searchPlaceholder.textContent = `‚ùå No s'ha trobat cap enlla√ß per "${searchValue || currentFilter}".`;
                searchPlaceholder.style.display = 'block';
            } else {
                searchPlaceholder.style.display = 'none';
            }
            
            clearSearchInputBtn.style.display = (searchValue.length > 0) ? 'block' : 'none';
            
            // Important: Re-renderitzar Lucide Icons als resultats de cerca
            if (typeof lucide !== 'undefined' && lucide.createIcons) {
                 lucide.createIcons();
            }
        }


        // --- Funci√≥ de Vista Compacta (Toggle) ---
        function toggleCompactView() {
            body.classList.toggle('compact-view-active');
            
            const icon = compactViewToggle.querySelector('[data-lucide]');
            if (body.classList.contains('compact-view-active')) {
                localStorage.setItem('emca-view', 'compact');
                icon.setAttribute('data-lucide', 'grip-vertical');
            } else {
                localStorage.setItem('emca-view', 'standard');
                icon.setAttribute('data-lucide', 'list');
            }
            if (typeof lucide !== 'undefined' && lucide.createIcons) {
                 lucide.createIcons(); // Re-renderitzar Lucide
            }


            if (searchModal.style.display === 'flex') {
                filterLinks(); // Refrescar modal si est√† obert
            }
        }

        // --- Inicialitzaci√≥ i Assignaci√≥ d'esdeveniments ---
        
        // Cerca
        openSearchModalBtn.addEventListener('click', () => toggleSearchModal(true));
        closeSearchModalBtn.addEventListener('click', () => toggleSearchModal(false));
        searchModal.addEventListener('click', (e) => {
            if (e.target.id === 'searchModal') { toggleSearchModal(false); }
        });
        searchInputModal.addEventListener('keyup', () => filterLinks());
        clearSearchInputBtn.addEventListener('click', () => {
            searchInputModal.value = '';
            filterLinks(); 
        });
        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => { filterLinks(btn.dataset.filter); });
        });
        
        // Modal Funci√≥ (Obrir/Tancar)
        function toggleSearchModal(show) {
            if (show) {
                searchModal.style.display = 'flex';
                // Reset del filtre al obrir
                filterLinks('all'); 
                setTimeout(() => searchInputModal.focus(), 100); 
            } else {
                searchInputModal.value = '';
                resultsList.innerHTML = ''; 
                clearSearchInputBtn.style.display = 'none'; 
                searchPlaceholder.textContent = 'Comen√ßa a escriure o selecciona un filtre...';
                searchPlaceholder.style.display = 'block';
                searchModal.style.display = 'none';
            }
        }


        // Vista Compacta
        compactViewToggle.addEventListener('click', toggleCompactView);

        // Mode Fosc
        darkModeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const icon = darkModeToggle.querySelector('[data-lucide]');
            if (document.body.classList.contains('dark-mode')) {
                localStorage.setItem('emca-theme', 'dark');
                icon.setAttribute('data-lucide', 'sun'); // Sol en mode fosc
            } else {
                localStorage.setItem('emca-theme', 'light');
                icon.setAttribute('data-lucide', 'moon'); // Lluna en mode clar
            }
            if (typeof lucide !== 'undefined' && lucide.createIcons) {
                 lucide.createIcons(); // Re-renderitzar Lucide
            }
        });

        // Assignaci√≥ d'esdeveniments per a les pestanyes
        tabHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const targetId = header.dataset.target;
                switchTab(targetId);
            });
        });

        // Carregar la prefer√®ncia i inicialitzar en carregar
        window.addEventListener('DOMContentLoaded', () => {
            // Carregar Mode Fosc
            if (localStorage.getItem('emca-theme') === 'dark') {
                document.body.classList.add('dark-mode');
                darkModeToggle.querySelector('[data-lucide]').setAttribute('data-lucide', 'sun');
            }

            // Carregar Vista Compacta
            if (localStorage.getItem('emca-view') === 'compact') {
                body.classList.add('compact-view-active');
                compactViewToggle.querySelector('[data-lucide]').setAttribute('data-lucide', 'grip-vertical');
            }
            
            // Activar la primera pestanya i inicialitzar collapsibles
            switchTab('tab-teoria');
            
            // CR√çTIC: Inicialitzar Lucide Icons despr√©s de carregar tot el DOM
            if (typeof lucide !== 'undefined' && lucide.createIcons) {
                 lucide.createIcons();
            }
        });

    </script>

</body>
</html>
